const CalendarView=(e=>{const t="calendarView",a="bs.calendar-view",n=`.${a}`,r=e.fn[t],s={CHANGE:`change${n}`,CLICK_DATA_API:`click${n}.data-api`,OVER_DATA_API:`mouseenter${n}.data-api`,SELECT:`select${n}`,OVER:`over${n}`},i={CALENDAR_VIEW:"calendar-view",MONTH_VIEW:"calendar-month-view",WEEK_VIEW:"calendar-week-view",DAY_VIEW:"calendar-day-view",DAY_VIEW_TODAY:"calendar-day-view-today",DAY_VIEW_INFOCUS:"calendar-day-view-infocus",DAY_VIEW_OUTFOCUS:"calendar-day-view-outfocus",DAY_VIEW_SELECTED:"calendar-day-view-selected",DAY_VIEW_START:"calendar-day-view-start",DAY_VIEW_END:"calendar-day-view-end",DAY_VIEW_BETWEEN:"calendar-day-view-between",DAY_VIEW_DISABLED:"calendar-day-view-disabled"},d={CALENDAR_VIEW:`.${i.CALENDAR_VIEW}`,MONTH_VIEW:`.${i.MONTH_VIEW}`,DAY_VIEW:`.${i.DAY_VIEW}`};class _{constructor(t){this._element=t,this._calendar="jalali",this._current=Pasoonate.make()[this._calendar](),this._weekViewElement="<tr>",this._dayViewElement="<td>",this.beforeRenderDayAction=(e=>e.getDay()),this.render(),e(this._element).trigger(e.Event(s.CHANGE,{current:Pasoonate.make(this._current.getTimestamp())[this._calendar]()}))}render(){this._goto()}beforeRenderDay([e]){"function"==typeof e&&(this.beforeRenderDayAction=e,this._renderMonthView())}weekViewElement([e]){this._weekViewElement="function"==typeof e?e():e}dayViewElement([e]){this._dayViewElement="function"==typeof e?e():e}goto([e,t,a]){this._goto(e,t,a)}nextMonth(){let e=Pasoonate.make(this._current.getTimestamp())[this._calendar]();e.addMonth(1),this._goto(e.getYear(),e.getMonth())}prevMonth(){let e=Pasoonate.make(this._current.getTimestamp())[this._calendar]();e.subMonth(1),this._goto(e.getYear(),e.getMonth())}selectDay([t]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(i.DAY_VIEW_SELECTED)}clearSelection([t]){t?e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).removeClass(i.DAY_VIEW_SELECTED):e(this._element).find(d.DAY_VIEW).removeClass(i.DAY_VIEW_SELECTED)}selectRange([t,a]){const[n,r,s]=String(t).split("-"),_=Pasoonate.make().gregorian().setDate(Number(n),Number(r),Number(s));for(e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(i.DAY_VIEW_START),e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${a}]`).addClass(i.DAY_VIEW_END),_.addDay(1);_.format("yyyy-mm-dd")!==a;)e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${_.format("yyyy-mm-dd")}]`).addClass(i.DAY_VIEW_BETWEEN),_.addDay(1)}clearRange(){e(this._element).find(d.DAY_VIEW).removeClass([i.DAY_VIEW_START,i.DAY_VIEW_END,i.DAY_VIEW_BETWEEN])}startDay([t]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(i.DAY_VIEW_START)}endDay([t]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(i.DAY_VIEW_END)}disableDay([t]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(i.DAY_VIEW_DISABLED)}enableDay([t]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).removeClass(i.DAY_VIEW_DISABLED)}addClass([t,a]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).addClass(a)}removeClass([t,a]){e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).removeClass(a)}hasClass([t,a,n]){n.value=e(this._element).find(`${d.DAY_VIEW}[data-gregorian-date=${t}]`).hasClass(a)}getFirstAndLastDay([t]){const a=e(this._element).find(`${d.DAY_VIEW}`);a.length&&(t.first=Number(a[0].dataset.pick),t.last=Number(a[a.length-1].dataset.pick))}_renderMonthView(){let t,a=e(this._element).find(d.MONTH_VIEW),n=Pasoonate.make()[this._calendar]();a.empty(),n.setTimestamp(this._current.getTimestamp()).setDay(1),t=n.subDay(n.dayOfWeek());for(let e=1;e<=6;e++)a.append(this._renderWeekView(t,e)),t.addDay(7)}_renderWeekView(t,a){let n=e(this._weekViewElement),r=Pasoonate.make(t.getTimestamp())[this._calendar]();n.addClass(i.WEEK_VIEW).addClass("week-"+a);for(let e=0;e<7;e++)n.append(this._renderDayView(r)),r.addDay(1);return n}_renderDayView(t){let a=this.beforeRenderDayAction(t),n=e(this._dayViewElement),r=Pasoonate.make()[this._calendar]();return n.addClass(i.DAY_VIEW),n.attr("data-pick",t.getTimestamp()),n.attr("data-gregorian-date",Pasoonate.make(t.getTimestamp()).gregorian().format("yyyy-mm-dd")),t.getMonth()===this._current.getMonth()?(n.attr("data-day",t.getDay()),n.addClass(i.DAY_VIEW_INFOCUS)):n.addClass(i.DAY_VIEW_OUTFOCUS),t.format("yyyy-mm-dd")===r.format("yyyy-mm-dd")&&n.addClass(i.DAY_VIEW_TODAY),n.html(a),n}_goto(t,a,n){let r=Pasoonate.make(this._current.getTimestamp())[this._calendar](),i=!1;if(i=(t&&t!=this._current.getYear())|(a&&a!=this._current.getMonth())|(n&&n!=this._current.getDay())){this._current.setYear(parseInt(t)||this._current.getYear()),this._current.setMonth(parseInt(a)||this._current.getMonth()),this._current.setDay(parseInt(n)||this._current.getDay());const i=e.Event(s.CHANGE,{old:r,current:Pasoonate.make(this._current.getTimestamp())[this._calendar]()});if(e(this._element).trigger(i),i.isDefaultPrevented())return void this._current.setTimestamp(r.getTimestamp())}this._renderMonthView()}static _jQueryInterface(t,...n){return this.each(function(){const r=e(this);let s=r.data(a);if(s||(s=new _(this),r.data(a,s)),"string"==typeof t){if(void 0===s[t])throw new TypeError(`No method named "${t}"`);s[t](n)}})}}return e(document).on(s.CLICK_DATA_API,`${d.DAY_VIEW}:not(${d.DAY_VIEW_DISABLED})`,function(){e(this).closest(d.CALENDAR_VIEW).trigger(e.Event(s.SELECT,{relatedTarget:this}))}).on(s.OVER_DATA_API,`${d.DAY_VIEW}:not(${d.DAY_VIEW_DISABLED})`,function(){e(this).closest(d.CALENDAR_VIEW).trigger(e.Event(s.OVER,{relatedTarget:this}))}),e.fn[t]=_._jQueryInterface,e.fn[t].Constructor=_,e.fn[t].noConflict=function(){return e.fn[t]=r,_._jQueryInterface},_})($);